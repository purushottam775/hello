<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Smart Student Budget Planner</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/chatbot.css">
</head>
<body class="dashboard-body">
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="dashboard.html" class="brand-link">
                    <i class="fas fa-dollar-sign"></i>
                    <span>SavvyMoney</span>
                </a>
                <button class="mobile-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="user-profile">
                <div class="profile-image">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-info">
                    <h3 id="userName">purushottam patil</h3>
                    <span class="user-role">Student Account</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <span class="nav-section-title">MAIN MENU</span>
                    <ul>
                        <li class="active">
                            <a href="dashboard.html">
                                <i class="fas fa-home"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="transactions.html">
                                <i class="fas fa-exchange-alt"></i>
                                <span>Transactions</span>
                            </a>
                        </li>
                        <li>
                            <a href="budget.html">
                                <i class="fas fa-chart-pie"></i>
                                <span>Budget</span>
                            </a>
                        </li>
                        <li>
                            <a href="Quiz.html">
                                <i class="fas fa-gamepad"></i>
                                <span>Quiz</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <span class="nav-section-title">PLANNING</span>
                    <ul>
                        <li>
                            <a href="goals.html">
                                <i class="fas fa-bullseye"></i>
                                <span>Goals</span>
                            </a>
                        </li>
                        <li>
                            <a href="reports.html">
                                <i class="fas fa-chart-bar"></i>
                                <span>Reports</span>
                            </a>
                        </li>
                        <li>
                            <a href="calendar.html">
                                <i class="fas fa-calendar"></i>
                                <span>Calendar</span>
                            </a>
                        </li>
                        <li>
                            <a href="currency-converter.html">
                                <i class="fas fa-coins"></i>
                                <span>Currency Converter</span>
                            </a>
                        </li>
                        <li>
                            <a href="bill-reminder.html">
                                <i class="fas fa-bell"></i>
                                <span>Bill Reminders</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="dashboard-header">
                <div class="header-left">
                    <button class="mobile-menu">
                        <i class="fas fa-bars"></i>
                    </button>
                    <a href="dashboard.html" class="brand-link-header">
                        <i class="fas fa-dollar-sign"></i>
                        <span>SavvyMoney</span>
                    </a>
                </div>
                <div class="header-right">
                    <div class="header-actions">
                        <a href="features.html" class="nav-link">Features</a>
                        <a href="settings.html" class="nav-link">Settings</a>
                        <a href="help.html" class="nav-link">Help</a>
                        <a href="#" class="nav-link" id="navbarChatbotLink" title="Chatbot"><i class="fas fa-robot"></i></a>
                        <a href="login.html" class="nav-link">Login</a>
                        <a href="signup.html" class="nav-link">Sign Up</a>
                        <button class="btn btn-primary" id="addTransactionBtn">
                            <i class="fas fa-plus"></i>
                            Add Transaction
                        </button>
                        <a href="#" class="nav-link logout-link" id="logoutButton">Logout</a>
                        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                            <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="display: block;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="display: none;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                            </svg>
                        </button>
                    </div>
                </div>
            </header>

            <div class="dashboard-content">
                <!-- New Hero Section -->
                <section class="hero-dashboard">
                    <div class="hero-content-dashboard">
                        <h1>Fuel Your Future with Financial Skills</h1>
                        <p>Take control of your finances with easy-to-use tools built just for students.
                            Learn how to budget, save smartly, and track every rupee you spend.
                            Build confidence in handling your money—step by step.
                            Your journey to financial freedom starts right here!</p>
                    </div>
                    <div class="hero-image-dashboard">
                        <div class="image-container">
                            <img src="img1.jpg" alt="Financial data visualization" class="overlay-image">
                        </div>
                    </div>
                </section>

                <!-- Card Grid Section -->
                <div class="card-grid-section">
                    <div class="dashboard-card">
                        <div class="card-icon"><img src="https://www.savvy.money/images/savvy-money-logo.png" alt="SavvyMoney Logo" style="width: 40px; height: 40px;"></div>
                        <h3>Stock Market News</h3>
                        <p>"An investment in knowledge pays the best interest"</p>
                        <a href="#" class="learn-more-btn">Read More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-chart-line"></i></div>
                        <h3>Finance Tracking</h3>
                        <p>Monitor all your transactions in real-time</p>
                        <a href="transactions.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-bullseye"></i></div>
                        <h3>Set Goals</h3>
                        <p>Define and achieve your financial targets</p>
                        <a href="goals.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-bell"></i></div>
                        <h3>Bill Reminders</h3>
                        <p>Never miss important payment deadlines</p>
                        <a href="bill-reminder.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-question-circle"></i></div>
                        <h3>FAQs</h3>
                        <p>Instant answers to common financial questions</p>
                        <a href="#" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-exchange-alt"></i></div>
                        <h3>Conversion Rates</h3>
                        <p>Real-time currency exchange information</p>
                        <a href="currency-converter.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-info-circle"></i></div>
                        <h3>About Us</h3>
                        <p>Learn more about SavvyMoney and our mission.</p>
                        <a href="aboutus.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-gamepad"></i></div>
                        <h3>Ultimate Quiz !!!</h3>
                        <p>Test your financial knowledge with our fun quiz.</p>
                        <a href="Quiz.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-chart-area"></i></div>
                        <h3>Analytics</h3>
                        <p>Detailed insights into your financial health.</p>
                        <a href="analytics.html" class="learn-more-btn">Learn More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-lightbulb" style="font-size: 40px; color: #FFD700;"></i></div>
                        <h3>Budget Planning Tips</h3>
                        <p>Learn effective strategies to manage your money and achieve financial stability.</p>
                        <a href="tips.html" class="learn-more-btn">Explore Tips</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><img src="https://images.unsplash.com/photo-1579621970588-a35d0e7ab996?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Investment Basics" style="width: 40px; height: 40px;"></div>
                        <h3>Reports</h3>
                        <p>Track your progress, spot trends, and make smarter financial decisions.Unlock financial clarity through organized and insightful reports.</p>
                        <a href="Report.html" class="learn-more-btn">Discover More</a>
                    </div>
                    <div class="dashboard-card">
                        <div class="card-icon"><i class="fas fa-calendar-alt"></i></div>
                        <h3>Calendar View</h3>
                        <p>Track your financial activities and events in a calendar format</p>
                        <a href="calendar.html" class="learn-more-btn">View Calendar</a>
                    </div>
                </div>

                <!-- New Financial Insights Section -->
                <section class="financial-insights-section">
                    <div class="insights-content">
                        <h2>Unlock Your Financial Potential</h2>
                        <p>Dive deeper into key financial concepts with our curated articles and guides. From understanding compound interest to navigating cryptocurrency, we provide clear, actionable insights.</p>
                        <a href="#financial-insights.html" class="btn btn-primary">Learn More About Finance</a>
                    </div>
                    <div class="insights-image">
                        <img src="https://images.unsplash.com/photo-1579621970588-a35d0e7ab996?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Financial Insights">
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- The chatbot container, toggle button, and window are created dynamically by public/js/chatbot.js. -->
    <!-- Do NOT add any chatbot HTML here. -->

    <!-- Modals (Transaction, Goal, Budget) remain the same -->
    <div class="modal" id="transactionModal" style="display:none;">
        <div class="modal-content" style="max-width:400px;margin:auto;padding:2rem;background:#fff;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.15);">
            <div class="modal-header" style="display:flex;justify-content:space-between;align-items:center;">
                <h2 style="margin:0;">Add Transaction</h2>
                <button class="close-modal" type="button" style="background:none;border:none;font-size:2rem;line-height:1;">&times;</button>
            </div>
            <form id="transactionForm" style="display:flex;flex-direction:column;gap:1rem;margin-top:1rem;">
                <div>
                    <label for="transactionType" style="font-weight:500;">Type</label>
                    <select id="transactionType" required style="width:100%;padding:0.5rem;">
                        <option value="expense">Expense</option>
                        <option value="income">Income</option>
                    </select>
                </div>
                <div>
                    <label for="transactionAmount" style="font-weight:500;">Amount</label>
                    <input type="number" id="transactionAmount" required min="0.01" step="0.01" style="width:100%;padding:0.5rem;" />
                </div>
                <div>
                    <label for="transactionCategory" style="font-weight:500;">Category</label>
                    <select id="transactionCategory" required style="width:100%;padding:0.5rem;">
                        <option value="entertainment">Entertainment</option>
                        <option value="food">Food</option>
                        <option value="shopping">Shopping</option>
                        <option value="health">Health</option>
                        <option value="education">Education</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div>
                    <label for="transactionDate" style="font-weight:500;">Date</label>
                    <input type="date" id="transactionDate" required style="width:100%;padding:0.5rem;" />
                </div>
                <div>
                    <label for="description" style="font-weight:500;">Note</label>
                    <textarea id="description" name="description" placeholder="Add a note (optional)" rows="3"></textarea>
                </div>
                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:1rem;">
                    <button type="button" class="btn close-modal" style="background:#eee;color:#333;padding:0.5rem 1.5rem;border-radius:6px;border:none;">Cancel</button>
                    <button type="submit" class="btn btn-primary" style="background:#4F46E5;color:#fff;padding:0.5rem 1.5rem;border-radius:6px;border:none;">Save Transaction</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="goalModal" style="display:none;">
        <div class="modal-content" style="max-width:400px;margin:auto;padding:2rem;background:#fff;border-radius:16px;box-shadow:0 8px 32px rgba(79,70,229,0.15);">
            <div class="modal-header" style="display:flex;justify-content:space-between;align-items:center;">
                <h2 style="margin:0;">Add Goal</h2>
                <button type="button" class="close-modal" style="background:none;border:none;font-size:2rem;">&times;</button>
            </div>
            <form id="goalForm" style="display:flex;flex-direction:column;gap:1rem;margin-top:1rem;">
                <input type="text" id="goalName" placeholder="Goal Name" required style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <input type="number" id="goalTarget" placeholder="Target Amount" required min="1" style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <input type="number" id="goalSaved" placeholder="Already Saved" required min="0" style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <button type="submit" class="btn btn-primary" style="background:#4F46E5;color:#fff;padding:0.5rem 1.5rem;border-radius:8px;font-weight:600;">Save Goal</button>
            </form>
        </div>
    </div>

    <div class="modal" id="budgetModal" style="display:none;">
        <div class="modal-content" style="max-width:400px;margin:auto;padding:2rem;background:#fff;border-radius:16px;box-shadow:0 8px 32px rgba(16,185,129,0.15);">
            <div class="modal-header" style="display:flex;justify-content:space-between;align-items:center;">
                <h2 style="margin:0;">Edit Budget</h2>
                <button class="close-modal" type="button" style="background:none;border:none;font-size:2rem;">&times;</button>
            </div>
            <form id="budgetForm" style="display:flex;flex-direction:column;gap:1rem;margin-top:1rem;">
                <input type="text" id="budgetName" placeholder="Category Name" required style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <input type="number" id="budgetLimit" placeholder="Limit Amount" required min="1" style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <input type="number" id="budgetSpent" placeholder="Already Spent" required min="0" style="padding:0.5rem;border-radius:6px;border:1px solid #ddd;">
                <button type="submit" class="btn btn-success" style="background:#10B981;color:#fff;padding:0.5rem 1.5rem;border-radius:8px;font-weight:600;">Save Budget</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="js/errorHandler.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/chatbot.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Theme Toggle Functionality
            const themeToggle = document.getElementById('themeToggle');
            const sunIcon = themeToggle.querySelector('.sun-icon');
            const moonIcon = themeToggle.querySelector('.moon-icon');

            // Check for saved theme preference
            const savedTheme = localStorage.getItem('theme') || 'dark'; 
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcons(savedTheme);

            themeToggle.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcons(newTheme);
            });

            function updateThemeIcons(theme) {
                if (theme === 'light') {
                    sunIcon.style.display = 'block';
                    moonIcon.style.display = 'none';
                } else {
                    sunIcon.style.display = 'none';
                    moonIcon.style.display = 'block';
                }
            }

            // Logout confirmation pop-up
            const logoutButton = document.getElementById('logoutButton');
            logoutButton.addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default link behavior
                if (confirm('Do you want to logout?')) {
                    window.location.href = 'login.html'; // Redirect to login page
                }
            });
            
            connectSocket();
            initializeDashboard();

            // Modal open/close for Add Transaction (assuming this is still desired)
            document.getElementById('addTransactionBtn').onclick = function() {
                document.getElementById('transactionModal').style.display = 'block';
            };
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.onclick = function() {
                    btn.closest('.modal').style.display = 'none';
                };
            });

            // Make Add Goal button open the modal
            document.getElementById('addGoalBtn').onclick = function() {
                document.getElementById('goalModal').style.display = 'block';
            };

            // Make Edit Budget button open the modal
            document.getElementById('editBudgetBtn').onclick = function() {
                document.getElementById('budgetModal').style.display = 'block';
            };
            
            // Handle clicks on the navbar chatbot link
            const navbarChatbotLink = document.getElementById('navbarChatbotLink');
            if (navbarChatbotLink) {
                navbarChatbotLink.addEventListener('click', (event) => {
                    event.preventDefault();
                    // The chatbotToggle button is created and managed by chatbot.js
                    // We need to wait for it to be created before trying to click it
                    const checkChatbotReady = setInterval(() => {
                        const chatbotToggle = document.getElementById('chatbotToggle');
                        if (chatbotToggle) {
                            clearInterval(checkChatbotReady);
                            chatbotToggle.click(); // Programmatically click the floating chatbot button
                        }
                    }, 100); // Check every 100ms
                });
            }
        });

        // The following functions might need re-evaluation or relocation based on the new card-based display.
        // Keeping them here for now, but they might be refactored into dashboard.js or removed if redundant.
        function updateDashboardUI(data) {
            // Update stats (these elements are no longer directly present in the new HTML structure)
            // If you want to display these stats within the cards or elsewhere, you'll need to adapt this.
            let income = 0, expenses = 0, savings = 0;
            data.transactions.forEach(tx => {
                if (tx.type === 'income') income += tx.amount;
                else if (tx.type === 'expense') expenses += tx.amount;
            });
            savings = income - expenses;
            // document.getElementById('totalIncome').textContent = `₹${income.toFixed(2)}`;
            // document.getElementById('totalExpenses').textContent = `₹${expenses.toFixed(2)}`;
            // document.getElementById('totalBalance').textContent = `₹${savings.toFixed(2)}`;
            // document.getElementById('totalSavings').textContent = `₹${savings.toFixed(2)}`;

            // Update recent transactions (if you have a dedicated card for this)
            // const transactionsList = document.getElementById('recentTransactions');
            // if (transactionsList) {
            //     transactionsList.innerHTML = data.transactions.slice(-5).reverse().map(transaction => `
            //         <div class="transaction-item ${transaction.type}">
            //             <div class="transaction-info">
            //                 <h4>${transaction.category}</h4>
            //                 <span>${transaction.description || ''}</span>
            //             </div>
            //             <div class="transaction-amount">
            //                 <span>${transaction.type === 'expense' ? '-' : '+'}${Math.abs(transaction.amount).toFixed(2)}</span>
            //                 <small>${new Date(transaction.date).toLocaleDateString()}</small>
            //             </div>
            //         </div>
            //     `).join('');
            // }

            // updateSavingsGoals(data.goals); // If you have a dedicated card for goals, adapt this.
        }
    </script>
</body>
</html> 